<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eden Presley - Rock - Portfolio</title>
    <link rel="stylesheet" href="../styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
</head>
<body class="page-fade-in">
    <!-- Navigation -->
    <nav class="project-nav">
        <a href="../index.html" class="back-button">‚Üê Back to Portfolio</a>
    </nav>

    <!-- Project Detail Content -->
    <main class="project-detail">
        <div class="project-media-container">
            <div class="project-pdf-container">
                <div id="pdf-pages-wrapper" class="pdf-pages-wrapper"></div>
            </div>
        </div>
        <div class="project-content">
            <h1 class="project-title">Eden Presley - Rock</h1>
            <div class="project-description">
                <p>A bold design project for Eden Presley with a rock theme, featuring dynamic layouts and strong visual impact.</p>
            </div>
        </div>
    </main>
    
    <script>
        // Initialize PDF.js worker
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
        
        const pdfUrl = '../assets/pdfs/ashley_zheng_-_eden_presley_rock.pdf';
        const pdfPagesWrapper = document.getElementById('pdf-pages-wrapper');
        let pdfDoc = null;
        const scale = 1.5;
        
        function loadPDF(url) {
            // Check if using file:// protocol
            if (window.location.protocol === 'file:') {
                pdfPagesWrapper.innerHTML = 
                    '<iframe src="' + url + '" style="width: 100%; height: 80vh; border: none;" type="application/pdf"></iframe>';
                return;
            }
            
            pdfPagesWrapper.innerHTML = '<p style="padding: 2rem; text-align: center; color: #666;">Loading PDF...</p>';
            
            pdfjsLib.getDocument({
                url: url,
                withCredentials: false
            }).promise.then(function(pdf) {
                pdfDoc = pdf;
                pdfPagesWrapper.innerHTML = '';
                
                // Render all pages in sequence
                for (let pageNum = 1; pageNum <= pdf.numPages; pageNum++) {
                    renderPage(pageNum);
                }
            }).catch(function(error) {
                console.error('Error loading PDF:', error);
                pdfPagesWrapper.innerHTML = 
                    '<p style="padding: 2rem; text-align: center; color: #666;">Error loading PDF: ' + error.message + '</p>' +
                    '<iframe src="' + url + '" style="width: 100%; height: 80vh; border: none;" type="application/pdf"></iframe>';
            });
        }
        
        function renderPage(pageNum) {
            pdfDoc.getPage(pageNum).then(function(page) {
                const viewport = page.getViewport({scale: scale});
                
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                canvas.height = viewport.height;
                canvas.width = viewport.width;
                canvas.className = 'pdf-page-canvas';
                
                const pageContainer = document.createElement('div');
                pageContainer.className = 'pdf-page-container';
                pageContainer.appendChild(canvas);
                
                pdfPagesWrapper.appendChild(pageContainer);
                
                const renderContext = {
                    canvasContext: ctx,
                    viewport: viewport
                };
                page.render(renderContext);
            }).catch(function(error) {
                console.error('Error rendering page ' + pageNum + ':', error);
            });
        }
        
        // Load PDF when page is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', loadPDF(pdfUrl));
        } else {
            loadPDF(pdfUrl);
        }
    </script>
</body>
</html>